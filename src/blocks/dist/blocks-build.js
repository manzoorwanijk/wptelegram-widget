!function(e,t){for(var n in t)e[n]=t[n]}(this,function(n){var r={};function a(e){if(r[e])return r[e].exports;var t=r[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,a),t.l=!0,t.exports}return a.m=n,a.c=r,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)a.d(n,r,function(e){return t[e]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=11)}([function(e,t){!function(){e.exports=this.wp.i18n}()},function(e,t){!function(){e.exports=this.wp.components}()},function(e,t){!function(){e.exports=this.wp.blockEditor}()},function(e,t){!function(){e.exports=this.wptelegram_widget}()},function(e,t){!function(){e.exports=this.wp.element}()},function(e,t){!function(){e.exports=this.wp.blocks}()},function(e,t){!function(){e.exports=this.wp.url}()},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);function s(t){var e=["widget_width","widget_height"].filter(function(e){return t[e]}).map(function(e){return"".concat(e,'="').concat(t[e],'"')}),n="[wptelegram-ajax-widget";return e.length&&(n+=" "+e.join(" ")),n+="]"}var d=n(0),r=n(5),u=n(2),h=n(1);n(7);Object(r.registerBlockType)("wptelegram/widget-ajax-channel-feed",{title:Object(d.__)("Telegram Channel Ajax Feed"),icon:"format-aside",category:"wptelegram",attributes:{widget_width:{type:"string",default:"100%"},widget_height:{type:"string",default:"600"}},edit:function(e){var t=e.attributes,n=e.setAttributes,r=e.className,a=t.widget_width,i=t.widget_height,o=[React.createElement(u.InspectorControls,{key:"controls"},React.createElement(h.PanelBody,{title:Object(d.__)("Widget Options")},React.createElement(h.TextControl,{label:Object(d.__)("Widget Width"),value:a,onChange:function(e){n({widget_width:e})}}),React.createElement(h.TextControl,{label:Object(d.__)("Widget Height"),value:i,onChange:function(e){n({widget_height:e})},type:"number"})))],c=React.createElement("label",null,React.createElement(h.Dashicon,{icon:"shortcode"}),React.createElement("span",null,Object(d.__)("Telegram Channel Ajax Feed"))),l=s(t);return[o,React.createElement("div",{className:r,key:"shortcode"},c,React.createElement("code",{className:"widget-shortcode"},l))]},save:function(e){var t=e.attributes,n=s(t);return React.createElement("div",null,n)}});n(8);Object(r.registerBlockType)("wptelegram/widget-channel-feed",{title:Object(d.__)("Telegram Channel Feed"),icon:"format-aside",category:"wptelegram",attributes:{widget_width:{type:"string",default:"100"},author_photo:{type:"string",default:"auto"},num_messages:{type:"string",default:"5"}},edit:function(e){var t=e.attributes,n=e.setAttributes,r=e.className,a=t.widget_width,i=t.author_photo,o=t.num_messages,c=[React.createElement(u.InspectorControls,{key:"controls"},React.createElement(h.PanelBody,{title:Object(d.__)("Widget Options")},React.createElement(h.TextControl,{label:Object(d.__)("Widget Width"),value:a,onChange:function(e){return n({widget_width:e})},type:"number",min:"10",max:"100"}),React.createElement(h.RadioControl,{label:Object(d.__)("Author Photo"),selected:i,onChange:function(e){return n({author_photo:e})},options:[{label:"Auto",value:"auto"},{label:"Always show",value:"always_show"},{label:"Always hide",value:"always_hide"}]}),React.createElement(h.TextControl,{label:Object(d.__)("Number of Messages"),value:o,onChange:function(e){return n({num_messages:e})},type:"number",min:"1",max:"50"})))],l=React.createElement("label",null,React.createElement(h.Dashicon,{icon:"shortcode"}),React.createElement("span",null,Object(d.__)("Telegram Channel Feed"))),s="[wptelegram-widget";return s+=t.widget_width?' widget_width="'.concat(t.widget_width,'"'):"",s+=' author_photo="'.concat(t.author_photo,'" num_messages="').concat(t.num_messages,'"]'),[c,React.createElement("div",{className:r,key:"shortcode"},l,React.createElement("code",{className:"widget-shortcode"},s))]},save:function(e){var t=e.attributes,n=t.widget_width,r=t.author_photo,a=t.num_messages,i='[wptelegram-widget author_photo="'.concat(r,'" num_messages="').concat(a,'"');return i+=n?' widget_width="'.concat(n,'"]'):"]",React.createElement("div",null,i)}});n(9);function a(e){var t=e.fill,n=void 0===t?"#ffffff":t;return React.createElement(p,{width:"19px",height:"16px",viewBox:"0 0 19 16"},React.createElement(l,{fill:"none"},React.createElement(f,{fill:n,d:"M0.465,6.638 L17.511,0.073 C18.078,-0.145 18.714,0.137 18.932,0.704 C19.009,0.903 19.026,1.121 18.981,1.33 L16.042,15.001 C15.896,15.679 15.228,16.111 14.549,15.965 C14.375,15.928 14.211,15.854 14.068,15.748 L8.223,11.443 C7.874,11.185 7.799,10.694 8.057,10.345 C8.082,10.311 8.109,10.279 8.139,10.249 L14.191,4.322 C14.315,4.201 14.317,4.002 14.195,3.878 C14.091,3.771 13.926,3.753 13.8,3.834 L5.602,9.138 C5.112,9.456 4.502,9.528 3.952,9.333 L0.486,8.112 C0.077,7.967 -0.138,7.519 0.007,7.11 C0.083,6.893 0.25,6.721 0.465,6.638 Z"})))}function i(e){var t=e.link,n=e.text,r=e.isEditing;return React.createElement(h.Button,{isLarge:!0,href:t,className:"join-link",icon:React.createElement(a,null),target:r?"_blank":null,rel:"noopener noreferrer"},n)}function o(e){var t=e.setAttributes,n=e.attributes,r=n.alignment,a=n.link,i=n.text;return Object(b.useEffect)(function(){a||t({link:g}),i||t({text:_})},[]),React.createElement(b.Fragment,null,React.createElement(u.InspectorControls,{key:"controls"},React.createElement(h.PanelBody,{title:Object(d.__)("Button details")},React.createElement(h.TextControl,{label:Object(d.__)("Channel Link"),value:a||"",onChange:function(e){return t({link:e})},type:"url"}),React.createElement(h.TextControl,{label:Object(d.__)("Button text"),value:i||"",onChange:function(e){return t({text:e})}}))),React.createElement(u.BlockControls,null,React.createElement(u.BlockAlignmentToolbar,{value:r,onChange:function(e){t({alignment:e})}})))}var c=wp.components,l=c.G,f=c.Path,p=c.SVG,b=n(4),m=n(3),g=(null===m.blocks||void 0===m.blocks?void 0:m.blocks.join_link_url)||"",_=(null===m.blocks||void 0===m.blocks?void 0:m.blocks.join_link_text)||"";function w(){return(w=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}Object(r.registerBlockType)("wptelegram/widget-join-channel",{title:Object(d.__)("Join Telegram Channel"),icon:React.createElement(a,{fill:"#555d66"}),category:"wptelegram",attributes:{link:{type:"string"},text:{type:"string"},alignment:{type:"string",default:"center"}},getEditWrapperProps:function(e){var t=e.alignment;if(["left","center","right","wide","full"].includes(t))return{"data-align":t}},edit:function(e){var t=e.attributes,n=e.setAttributes,r=e.className;return React.createElement(React.Fragment,null,React.createElement(o,{attributes:t,setAttributes:n}),React.createElement("div",{className:r,key:"preview"},React.createElement(i,w({},t,{isEditing:!0}))))},save:function(e){var t=e.attributes,n=t.alignment;return React.createElement("div",{className:"wp-block-wptelegram-widget-join-channel align"+n},React.createElement(i,t))}});n(10);function y(e){var t=e.error,n=e.label,r=e.onChangeURL,a=e.onSubmit,i=e.url,o=t?{border:"2px solid #f71717"}:{};return React.createElement(h.Placeholder,{icon:"wordpress-alt",label:n,className:"wp-block-embed-telegram"},React.createElement("form",{onSubmit:a},React.createElement("input",{"aria-label":n,className:"components-placeholder__input",onChange:r,placeholder:"https://t.me/WPTelegram/102",style:o,type:"url",value:i||""}),React.createElement(h.Button,{isLarge:!0,type:"submit"},Object(d.__)("Embed"))))}function v(e){var t=e.userpic,n=e.toggleUserPic,r=e.showEditButton,a=e.switchBackToURLInput,i=e.alignment,o=e.changeAlignment;return React.createElement(b.Fragment,null,React.createElement(u.InspectorControls,null,React.createElement(h.PanelBody,{title:Object(d.__)("Options")},React.createElement(h.ToggleControl,{label:Object(d.__)("Author Photo"),checked:t,onChange:n}))),React.createElement(u.BlockControls,null,React.createElement(u.BlockAlignmentToolbar,{value:i,onChange:o}),React.createElement(h.Toolbar,null,r&&React.createElement(h.Button,{className:"components-toolbar__control",label:Object(d.__)("Edit URL"),icon:"edit",onClick:a}))))}var R=n(6);function E(e){return(E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function k(e,t){k=function(e,t){return new n(e,void 0,t)};var a=j(RegExp),i=RegExp.prototype,o=new WeakMap;function n(e,t,n){var r=a.call(this,e,t);return o.set(r,n||o.get(e)),r}function c(n,e){var r=o.get(e);return Object.keys(r).reduce(function(e,t){return e[t]=n[r[t]],e},Object.create(null))}return x(n,a),n.prototype.exec=function(e){var t=i.exec.call(this,e);return t&&(t.groups=c(t,this)),t},n.prototype[Symbol.replace]=function(e,t){if("string"==typeof t){var n=o.get(this);return i[Symbol.replace].call(this,e,t.replace(/\$<([^>]+)>/g,function(e,t){return"$"+n[t]}))}if("function"!=typeof t)return i[Symbol.replace].call(this,e,t);var r=this;return i[Symbol.replace].call(this,e,function(){var e=[];return e.push.apply(e,arguments),"object"!==E(e[e.length-1])&&e.push(c(e,r)),t.apply(this,e)})},k.apply(this,arguments)}function j(e){var r="function"==typeof Map?new Map:void 0;return(j=function(e){if(null===e||(t=e,-1===Function.toString.call(t).indexOf("[native code]")))return e;var t;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==r){if(r.has(e))return r.get(e);r.set(e,n)}function n(){return O(e,arguments,L(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),S(n,e)})(e)}function O(e,t,n){return(O=P()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var a=new(Function.bind.apply(e,r));return n&&S(a,n.prototype),a}).apply(null,arguments)}function C(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function x(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&S(e,t)}function S(e,t){return(S=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function T(i){var o=P();return function(){var e,t,n,r=L(i);if(o){var a=L(this).constructor;e=Reflect.construct(r,arguments,a)}else e=r.apply(this,arguments);return t=this,!(n=e)||"object"!==E(n)&&"function"!=typeof n?B(t):n}}function B(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function P(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function L(e){return(L=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var U=(null===m.blocks||void 0===m.blocks?void 0:m.blocks.assets).message_view_url,N=function(){x(a,b["Component"]);var e,t,n,r=T(a);function a(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(e=r.apply(this,arguments)).iframe_ref=Object(b.createRef)(),e.switchBackToURLInput=e.switchBackToURLInput.bind(B(e)),e.getIframeSrc=e.getIframeSrc.bind(B(e)),e.toggleUserPic=e.toggleUserPic.bind(B(e)),e.resizeIframe=e.resizeIframe.bind(B(e)),e.setUrl=e.setUrl.bind(B(e)),e.state={loading:!0,editingURL:!1,error:!1,url:e.props.attributes.url,userpic:e.props.attributes.userpic,iframe_height:null},e}return e=a,(t=[{key:"toggleUserPic",value:function(){var e=!this.state.userpic,t=this.props.attributes.iframe_src;t=Object(R.addQueryArgs)(t,{userpic:e}),this.setState({userpic:e,loading:!0}),this.props.setAttributes({userpic:e,iframe_src:t})}},{key:"setUrl",value:function(e){e&&e.preventDefault();var t=this.state.url,n=k(/^(?:https?:\/\/)?t\.me\/([a-z][0-9_a-z]{3,30}[0-9a-z])\/([0-9]+)$/i,{username:1,message_id:2}),r=t.match(n);if(null===r)this.setState({error:!0});else{var a=this.getIframeSrc(r.groups),i=this.props.setAttributes;this.setState({loading:!0,editingURL:!1,error:!1}),i({url:t,iframe_src:a})}}},{key:"getIframeSrc",value:function(e){return U.replace("%username%",e.username).replace("%message_id%",e.message_id).replace("%userpic%",this.state.userpic)}},{key:"switchBackToURLInput",value:function(){this.setState({editingURL:!0})}},{key:"componentDidMount",value:function(){window.addEventListener("resize",this.resizeIframe)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.resizeIframe)}},{key:"resizeIframe",value:function(){if(null!==this.iframe_ref.current&&void 0!==this.iframe_ref.current.contentWindow){var e=this.iframe_ref.current.contentWindow.document.body.scrollHeight;e!==this.state.iframe_height&&this.setState({iframe_height:e})}}},{key:"render",value:function(){var t=this,e=this.state,n=e.loading,r=e.editingURL,a=e.url,i=e.error,o=e.userpic,c=this.props,l=c.className,s=c.setAttributes,u=this.props.attributes,f=u.alignment,p=u.iframe_src,m=Object(d.__)("Telegram post URL");if(r||!p)return React.createElement(y,{label:m,error:i,url:a,onChangeURL:function(e){return t.setState({url:e.target.value})},onSubmit:this.setUrl});var g=n?0:this.state.iframe_height;return React.createElement(b.Fragment,null,React.createElement(v,{userpic:o,toggleUserPic:this.toggleUserPic,showEditButton:!0,switchBackToURLInput:this.switchBackToURLInput,alignment:f,changeAlignment:function(e){t.resizeIframe(),s({alignment:e})}}),n&&React.createElement("div",{className:"wp-block-embed is-loading"},React.createElement(h.Spinner,null),React.createElement("p",null,Object(d.__)("Loading…"))),React.createElement("div",{className:l+" wptelegram-widget-message"},React.createElement("div",{className:"wp-block-embed__content-wrapper"},React.createElement(h.FocusableIframe,{iframeRef:this.iframe_ref,frameBorder:"0",scrolling:"no",src:p,onLoad:function(){t.setState({loading:!1}),t.resizeIframe()},height:g},"Your Browser Does Not Support iframes!"))))}}])&&C(e.prototype,t),n&&C(e,n),a}(),I={url:{type:"string",default:""},iframe_src:{type:"string",default:""},userpic:{type:"boolean",default:!0},alignment:{type:"string",default:"center"}};Object(r.registerBlockType)("wptelegram/widget-single-post",{title:Object(d.__)("Telegram Single Post"),icon:"format-aside",category:"wptelegram",getEditWrapperProps:function(e){var t=e.alignment;if(["left","center","right","wide","full"].includes(t))return{"data-align":t}},attributes:I,edit:N,save:function(e){var t=e.attributes,n=t.alignment,r=t.iframe_src;return React.createElement("div",{className:"wp-block-wptelegram-widget-single-post wptelegram-widget-message align"+n},React.createElement("iframe",{title:"Telegram post",frameBorder:"0",scrolling:"no",src:r},"Your Browser Does Not Support iframes!"))},deprecated:[{attributes:I,save:function(e){var t=e.attributes,n=t.alignment,r=t.iframe_src;return React.createElement("div",{className:"wp-block-wptelegram-widget-single-post wptelegram-widget-message align"+n},React.createElement("iframe",{frameBorder:"0",scrolling:"no",src:r},"Your Browser Does Not Support iframes!"))}}]})}]));