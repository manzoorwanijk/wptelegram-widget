!function(n){var r={};function a(e){if(r[e])return r[e].exports;var t=r[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,a),t.l=!0,t.exports}a.m=n,a.c=r,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)a.d(n,r,function(e){return t[e]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=5)}([function(e,t){e.exports=wptelegram_widget},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);n(1);function s(t){var e=["widget_width","widget_height"].filter(function(e){return t[e]}).map(function(e){return"".concat(e,'="').concat(t[e],'"')}),n="[wptelegram-ajax-widget";return e.length&&(n+=" "+e.join(" ")),n+="]"}var u=wp.i18n.__,r=wp.blocks.registerBlockType,p=wp.blockEditor.InspectorControls,a=wp.components,m=a.PanelBody,f=a.TextControl,g=a.Dashicon;r("wptelegram/widget-ajax-channel-feed",{title:u("Telegram Channel Ajax Feed"),icon:"format-aside",category:"widgets",attributes:{widget_width:{type:"string",default:"100%"},widget_height:{type:"string",default:"600"}},edit:function(e){var t=e.attributes,n=e.setAttributes,r=e.className,a=t.widget_width,o=t.widget_height,i=[React.createElement(p,{key:"controls"},React.createElement(m,{title:u("Widget Options")},React.createElement(f,{label:u("Widget Width"),value:a,onChange:function(e){return n({widget_width:e})}}),React.createElement(f,{label:u("Widget Height"),value:o,onChange:function(e){return n({widget_height:e})},type:"number"})))],l=React.createElement("label",null,React.createElement(g,{icon:"shortcode"}),React.createElement("span",null,u("Telegram Channel Ajax Feed"))),c=s(t);return[i,React.createElement("div",{className:r,key:"shortcode"},l,React.createElement("code",{className:"widget-shortcode"},c))]},save:function(e){var t=e.attributes,n=s(t);return React.createElement("div",null,n)}});n(2);var d=wp.i18n.__,o=wp.blocks.registerBlockType,h=wp.blockEditor.InspectorControls,i=wp.components,w=i.PanelBody,b=i.RadioControl,y=i.TextControl,v=i.Dashicon;o("wptelegram/widget-channel-feed",{title:d("Telegram Channel Feed"),icon:"format-aside",category:"widgets",attributes:{widget_width:{type:"string",default:"100"},author_photo:{type:"string",default:"auto"},num_messages:{type:"string",default:"5"}},edit:function(e){var t=e.attributes,n=e.setAttributes,r=e.className,a=t.widget_width,o=t.author_photo,i=t.num_messages,l=[React.createElement(h,{key:"controls"},React.createElement(w,{title:d("Widget Options")},React.createElement(y,{label:d("Widget Width"),value:a,onChange:function(e){return n({widget_width:e})},type:"number",min:"10",max:"100"}),React.createElement(b,{label:d("Author Photo"),selected:o,onChange:function(e){return n({author_photo:e})},options:[{label:"Auto",value:"auto"},{label:"Always show",value:"always_show"},{label:"Always hide",value:"always_hide"}]}),React.createElement(y,{label:d("Number of Messages"),value:i,onChange:function(e){return n({num_messages:e})},type:"number",min:"1",max:"50"})))],c=React.createElement("label",null,React.createElement(v,{icon:"shortcode"}),React.createElement("span",null,d("Telegram Channel Feed"))),s="[wptelegram-widget";return s+=t.widget_width?' widget_width="'.concat(t.widget_width,'"'):"",s+=' author_photo="'.concat(t.author_photo,'" num_messages="').concat(t.num_messages,'"]'),[l,React.createElement("div",{className:r,key:"shortcode"},c,React.createElement("code",{className:"widget-shortcode"},s))]},save:function(e){var t=e.attributes,n=t.widget_width,r=t.author_photo,a=t.num_messages,o='[wptelegram-widget author_photo="'.concat(r,'" num_messages="').concat(a,'"');return o+=n?' widget_width="'.concat(n,'"]'):"]",React.createElement("div",null,o)}});n(3);function l(e){var t=e.fill,n=void 0===t?"#ffffff":t;return React.createElement(C,{width:"19px",height:"16px",viewBox:"0 0 19 16"},React.createElement(E,{fill:"none"},React.createElement(k,{fill:n,d:"M0.465,6.638 L17.511,0.073 C18.078,-0.145 18.714,0.137 18.932,0.704 C19.009,0.903 19.026,1.121 18.981,1.33 L16.042,15.001 C15.896,15.679 15.228,16.111 14.549,15.965 C14.375,15.928 14.211,15.854 14.068,15.748 L8.223,11.443 C7.874,11.185 7.799,10.694 8.057,10.345 C8.082,10.311 8.109,10.279 8.139,10.249 L14.191,4.322 C14.315,4.201 14.317,4.002 14.195,3.878 C14.091,3.771 13.926,3.753 13.8,3.834 L5.602,9.138 C5.112,9.456 4.502,9.528 3.952,9.333 L0.486,8.112 C0.077,7.967 -0.138,7.519 0.007,7.11 C0.083,6.893 0.25,6.721 0.465,6.638 Z"})))}function c(e){var t=e.link,n=e.text,r=e.isEditing;return React.createElement(S,{isLarge:!0,href:t,className:"join-link",icon:React.createElement(l,null),target:r?"_blank":null,rel:"noopener noreferrer"},n)}function R(e){var t=e.setAttributes,n=e.attributes,r=n.alignment,a=n.link,o=n.text;return A(function(){a||t({link:"https://t.me/".concat(W)}),o||t({text:"Join @".concat(W," on Telegram")})},[]),React.createElement(B,null,React.createElement(j,{key:"controls"},React.createElement(N,{title:T("Button details")},React.createElement(I,{label:T("Channel Link"),value:a||"",onChange:function(e){return t({link:e})},type:"url"}),React.createElement(I,{label:T("Button text"),value:o||"",onChange:function(e){return t({text:e})}}))),React.createElement(L,null,React.createElement(O,{value:r,onChange:function(e){t({alignment:e})}})))}var _=wp.components,E=_.G,k=_.Path,C=_.SVG,S=wp.components.Button,x=n(0),T=wp.i18n.__,B=wp.element.Fragment,P=wp.blockEditor,j=P.InspectorControls,L=P.BlockControls,O=P.BlockAlignmentToolbar,U=wp.components,N=U.PanelBody,I=U.TextControl,A=wp.element.useEffect,W=(null===x.blocks||void 0===x.blocks?void 0:x.blocks.username)||"WPTelegram";function z(){return(z=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var F=wp.i18n.__;(0,wp.blocks.registerBlockType)("wptelegram/widget-join-channel",{title:F("Join Telegram Channel"),icon:React.createElement(l,{fill:"#555d66"}),category:"widgets",attributes:{link:{type:"string"},text:{type:"string"},alignment:{type:"string",default:"center"}},getEditWrapperProps:function(e){var t=e.alignment;if(["left","center","right","wide","full"].includes(t))return{"data-align":t}},edit:function(e){var t=e.attributes,n=e.setAttributes,r=e.className;return React.createElement(React.Fragment,null,React.createElement(R,{attributes:t,setAttributes:n}),React.createElement("div",{className:r,key:"preview"},React.createElement(c,z({},t,{isEditing:!0}))))},save:function(e){var t=e.attributes,n=t.alignment;return React.createElement("div",{className:"wp-block-wptelegram-widget-join-channel align"+n},React.createElement(c,t))}});n(4);function M(e){var t=e.label,n=e.url,r=e.onSubmit,a=e.onChangeURL,o=e.error?{border:"2px solid #f71717"}:{};return React.createElement(H,{icon:"wordpress-alt",label:t,className:"wp-block-embed-telegram"},React.createElement("form",{onSubmit:r},React.createElement("input",{style:o,type:"url",value:n||"",className:"components-placeholder__input","aria-label":t,placeholder:"https://t.me/WPTelegram/102",onChange:a}),React.createElement(G,{isLarge:!0,type:"submit"},Y("Embed"))))}function D(e){var t=e.userpic,n=e.toggleUserPic,r=e.showEditButton,a=e.switchBackToURLInput,o=e.alignment,i=e.changeAlignment;return React.createElement(Q,null,React.createElement(Z,null,React.createElement(ee,{title:J("Options")},React.createElement(re,{label:J("Author Photo"),checked:t,onChange:n}))),React.createElement(q,null,React.createElement(K,{value:o,onChange:i}),React.createElement(ne,null,r&&React.createElement(te,{className:"components-toolbar__control",label:J("Edit URL"),icon:"edit",onClick:a}))))}var Y=wp.i18n.__,$=wp.components,G=$.Button,H=$.Placeholder,J=wp.i18n.__,Q=wp.element.Fragment,V=wp.blockEditor,Z=V.InspectorControls,q=V.BlockControls,K=V.BlockAlignmentToolbar,X=wp.components,ee=X.PanelBody,te=X.Button,ne=X.Toolbar,re=X.ToggleControl;function ae(e){return(ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function oe(e,t){oe=function(e,t){return new n(e,void 0,t)};var a=ie(RegExp),o=RegExp.prototype,i=new WeakMap;function n(e,t,n){var r=a.call(this,e,t);return i.set(r,n||i.get(e)),r}function l(n,e){var r=i.get(e);return Object.keys(r).reduce(function(e,t){return e[t]=n[r[t]],e},Object.create(null))}return se(n,a),n.prototype.exec=function(e){var t=o.exec.call(this,e);return t&&(t.groups=l(t,this)),t},n.prototype[Symbol.replace]=function(e,t){if("string"==typeof t){var n=i.get(this);return o[Symbol.replace].call(this,e,t.replace(/\$<([^>]+)>/g,function(e,t){return"$"+n[t]}))}if("function"!=typeof t)return o[Symbol.replace].call(this,e,t);var r=this;return o[Symbol.replace].call(this,e,function(){var e=[];return e.push.apply(e,arguments),"object"!==ae(e[e.length-1])&&e.push(l(e,r)),t.apply(this,e)})},oe.apply(this,arguments)}function ie(e){var r="function"==typeof Map?new Map:void 0;return(ie=function(e){if(null===e||(t=e,-1===Function.toString.call(t).indexOf("[native code]")))return e;var t;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==r){if(r.has(e))return r.get(e);r.set(e,n)}function n(){return le(e,arguments,ge(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),ue(n,e)})(e)}function le(e,t,n){return(le=fe()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var a=new(Function.bind.apply(e,r));return n&&ue(a,n.prototype),a}).apply(null,arguments)}function ce(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function se(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ue(e,t)}function ue(e,t){return(ue=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function pe(o){return function(){var e,t,n,r=ge(o);if(fe()){var a=ge(this).constructor;e=Reflect.construct(r,arguments,a)}else e=r.apply(this,arguments);return t=this,!(n=e)||"object"!==ae(n)&&"function"!=typeof n?me(t):n}}function me(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fe(){if("undefined"!=typeof Reflect&&Reflect.construct&&!Reflect.construct.sham){if("function"==typeof Proxy)return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch(e){return}}}function ge(e){return(ge=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var de=wp.element,he=de.Component,we=de.Fragment,be=de.createRef,ye=wp.i18n.__,ve=wp.components,Re=ve.FocusableIframe,_e=ve.Spinner,Ee=wp.url.addQueryArgs,ke=x.blocks.assets.message_view_url,Ce=function(){se(a,he);var e,t,n,r=pe(a);function a(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(e=r.apply(this,arguments)).iframe_ref=be(),e.switchBackToURLInput=e.switchBackToURLInput.bind(me(e)),e.getIframeSrc=e.getIframeSrc.bind(me(e)),e.toggleUserPic=e.toggleUserPic.bind(me(e)),e.resizeIframe=e.resizeIframe.bind(me(e)),e.setUrl=e.setUrl.bind(me(e)),e.state={loading:!0,editingURL:!1,error:!1,url:e.props.attributes.url,userpic:e.props.attributes.userpic,iframe_height:null},e}return e=a,(t=[{key:"toggleUserPic",value:function(){var e=!this.state.userpic,t=this.props.attributes.iframe_src;t=Ee(t,{userpic:e}),this.setState({userpic:e,loading:!0}),this.props.setAttributes({userpic:e,iframe_src:t})}},{key:"setUrl",value:function(e){e&&e.preventDefault();var t=this.state.url,n=oe(/^(?:https?:\/\/)?t\.me\/([a-z][0-9_a-z]{3,30}[0-9a-z])\/([0-9]+)$/i,{username:1,message_id:2}),r=t.match(n);if(null===r)this.setState({error:!0});else{var a=this.getIframeSrc(r.groups),o=this.props.setAttributes;this.setState({loading:!0,editingURL:!1,error:!1}),o({url:t,iframe_src:a})}}},{key:"getIframeSrc",value:function(e){return ke.replace("%username%",e.username).replace("%message_id%",e.message_id).replace("%userpic%",this.state.userpic)}},{key:"switchBackToURLInput",value:function(){this.setState({editingURL:!0})}},{key:"componentDidMount",value:function(){window.addEventListener("resize",this.resizeIframe)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.resizeIframe)}},{key:"resizeIframe",value:function(){if(null!==this.iframe_ref.current&&void 0!==this.iframe_ref.current.contentWindow){var e=this.iframe_ref.current.contentWindow.document.body.scrollHeight;e!==this.state.iframe_height&&this.setState({iframe_height:e})}}},{key:"render",value:function(){var t=this,e=this.state,n=e.loading,r=e.editingURL,a=e.url,o=e.error,i=e.userpic,l=this.props,c=l.className,s=l.setAttributes,u=this.props.attributes,p=u.alignment,m=u.iframe_src,f=ye("Telegram post URL");if(r||!m)return React.createElement(M,{label:f,error:o,url:a,onChangeURL:function(e){return t.setState({url:e.target.value})},onSubmit:this.setUrl});var g=n?0:this.state.iframe_height;return React.createElement(we,null,React.createElement(D,{userpic:i,toggleUserPic:this.toggleUserPic,showEditButton:!0,switchBackToURLInput:this.switchBackToURLInput,alignment:p,changeAlignment:function(e){t.resizeIframe(),s({alignment:e})}}),n&&React.createElement("div",{className:"wp-block-embed is-loading"},React.createElement(_e,null),React.createElement("p",null,ye("Loading…"))),React.createElement("div",{className:c+" wptelegram-widget-message"},React.createElement("div",{className:"wp-block-embed__content-wrapper"},React.createElement(Re,{iframeRef:this.iframe_ref,frameBorder:"0",scrolling:"no",src:m,onLoad:function(){t.setState({loading:!1}),t.resizeIframe()},height:g},"Your Browser Does Not Support iframes!"))))}}])&&ce(e.prototype,t),n&&ce(e,n),a}(),Se=wp.i18n.__,xe={url:{type:"string",default:""},iframe_src:{type:"string",default:""},userpic:{type:"boolean",default:!0},alignment:{type:"string",default:"center"}};(0,wp.blocks.registerBlockType)("wptelegram/widget-single-post",{title:Se("Telegram Single Post"),icon:"format-aside",category:"widgets",getEditWrapperProps:function(e){var t=e.alignment;if(["left","center","right","wide","full"].includes(t))return{"data-align":t}},attributes:xe,edit:Ce,save:function(e){var t=e.attributes,n=t.alignment,r=t.iframe_src;return React.createElement("div",{className:"wp-block-wptelegram-widget-single-post wptelegram-widget-message align"+n},React.createElement("iframe",{title:"Telegram post",frameBorder:"0",scrolling:"no",src:r},"Your Browser Does Not Support iframes!"))},deprecated:[{attributes:xe,save:function(e){var t=e.attributes,n=t.alignment,r=t.iframe_src;return React.createElement("div",{className:"wp-block-wptelegram-widget-single-post wptelegram-widget-message align"+n},React.createElement("iframe",{frameBorder:"0",scrolling:"no",src:r},"Your Browser Does Not Support iframes!"))}}]})}]);